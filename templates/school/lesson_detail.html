{% extends 'school/base_generic.html' %}

{% block title %}{{ lesson.name }}{% endblock %}

{% block content %}
<div class="lesson-detail-box">
    <h1>{{ lesson.name }}</h1>

    <div class="lesson-info">
        <p><strong>Description:</strong></p>
        <p>{{ lesson.description }}</p>
        <p><strong>Subject:</strong> {{ subject_name }}</p>
    </div>

    <div class="lesson-files">
        {% if lesson.file_text %}
            <div class="file-item">
                üìÑ <strong>Text File:</strong>
                <a href="{{ lesson.file_text.url }}" class="file-link" download>Download</a>
            </div>
        {% endif %}

        {% if lesson.file_audio %}
            <div class="file-item">
                üéß <strong>Audio:</strong>
                <audio controls>
                    <source src="{{ lesson.file_audio.url }}" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
                <a href="{{ lesson.file_audio.url }}" class="file-link" download>Download Audio</a>
            </div>
        {% endif %}

        {% if lesson.video %}
            <div class="file-item">
                üé• <strong>Video:</strong>
                <video controls width="100%" height="auto">
                    <source src="{{ lesson.video.url }}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                <a href="{{ lesson.video.url }}" class="file-link" download>Download Video</a>
            </div>
        {% endif %}
    </div>

    {% if request.user.role == "teacher" %}
        <div class="lesson-actions">

            {% if not lesson.processed %}
            <button class="btn btn-primary" id="process-btn" data-lesson-id="{{ lesson.id }}"> ‚öôÔ∏è Process File</button>
            {% endif %}

            <form method="post" action="{% url 'delete_lesson' lesson.pk %}" onsubmit="return confirm('Are you sure you want to delete this lesson?');">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">üóëÔ∏è Delete Lesson</button>
            </form>
        </div>
    {% endif %}
</div>
{% endblock %}
